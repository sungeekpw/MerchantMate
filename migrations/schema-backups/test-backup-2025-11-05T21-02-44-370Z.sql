-- Database backup for test environment
-- Generated at: 2025-11-05T21:02:44.476Z
-- Warning: This is a simplified backup for migration safety

CREATE TABLE public.acquirer_application_templates (signature_groups jsonb DEFAULT '[]'::jsonb, pdf_mapping_configuration jsonb, created_at timestamp without time zone NOT NULL DEFAULT now(), address_groups jsonb DEFAULT '[]'::jsonb, acquirer_id integer NOT NULL, is_active boolean NOT NULL DEFAULT true, version text NOT NULL DEFAULT '1.0'::text, conditional_fields jsonb, field_configuration jsonb NOT NULL, template_name text NOT NULL, required_fields ARRAY NOT NULL DEFAULT ARRAY[]::text[], id integer NOT NULL DEFAULT nextval('acquirer_application_templates_id_seq'::regclass), updated_at timestamp without time zone NOT NULL DEFAULT now());
CREATE TABLE public.acquirers (created_at timestamp without time zone NOT NULL DEFAULT now(), id integer NOT NULL DEFAULT nextval('acquirers_id_seq'::regclass), description text, code text NOT NULL, display_name text NOT NULL, is_active boolean NOT NULL DEFAULT true, name text NOT NULL, updated_at timestamp without time zone NOT NULL DEFAULT now());
CREATE TABLE public.action_activity (status_message text, id integer NOT NULL DEFAULT nextval('action_activity_id_seq'::regclass), action_template_id integer, context_data jsonb, status character varying NOT NULL, recipient_name character varying, action_type character varying NOT NULL, executed_at timestamp without time zone DEFAULT now(), failed_at timestamp without time zone, trigger_source character varying, trigger_action_id integer, response_data jsonb, delivered_at timestamp without time zone, trigger_id integer, recipient character varying NOT NULL, triggered_by character varying, retry_count integer DEFAULT 0);
CREATE TABLE public.action_templates (description text, variables jsonb, category character varying NOT NULL, updated_at timestamp without time zone DEFAULT now(), version integer DEFAULT 1, id integer NOT NULL DEFAULT nextval('action_templates_id_seq'::regclass), created_at timestamp without time zone DEFAULT now(), action_type character varying NOT NULL, is_active boolean DEFAULT true, config jsonb NOT NULL, name character varying NOT NULL);
CREATE TABLE public.addresses (street1 text NOT NULL, street2 text, postal_code text NOT NULL, timezone text, location_id integer, geo_accuracy real, id integer NOT NULL DEFAULT nextval('addresses_id_seq'::regclass), geocoded_at timestamp without time zone, type text NOT NULL DEFAULT 'primary'::text, country text NOT NULL DEFAULT 'US'::text, created_at timestamp without time zone NOT NULL DEFAULT now(), city text NOT NULL, latitude real, state text NOT NULL, longitude real);
CREATE TABLE public.agent_merchants (merchant_id integer NOT NULL, id integer NOT NULL DEFAULT nextval('agent_merchants_id_seq'::regclass), assigned_by text, agent_id integer NOT NULL, assigned_at timestamp without time zone DEFAULT now());
CREATE TABLE public.agents (status text NOT NULL DEFAULT 'active'::text, last_name text NOT NULL, id integer NOT NULL DEFAULT nextval('agents_id_seq'::regclass), created_at timestamp without time zone DEFAULT now(), commission_rate numeric DEFAULT 5.00, first_name text NOT NULL, user_id character varying NOT NULL, company_id integer NOT NULL, territory text);
CREATE TABLE public.api_keys (key_secret text NOT NULL, rate_limit integer DEFAULT 1000, id integer NOT NULL DEFAULT nextval('api_keys_id_seq'::regclass), permissions jsonb NOT NULL DEFAULT '[]'::jsonb, name text NOT NULL, last_used_at timestamp without time zone, key_id text NOT NULL, is_active boolean DEFAULT true, updated_at timestamp without time zone NOT NULL DEFAULT now(), contact_email text NOT NULL, created_at timestamp without time zone NOT NULL DEFAULT now(), organization_name text, expires_at timestamp without time zone);
CREATE TABLE public.api_request_logs (method text NOT NULL, created_at timestamp without time zone NOT NULL DEFAULT now(), error_message text, user_agent text, status_code integer NOT NULL, response_size integer, response_time integer, endpoint text NOT NULL, id integer NOT NULL DEFAULT nextval('api_request_logs_id_seq'::regclass), request_size integer, api_key_id integer, ip_address text);
CREATE TABLE public.audit_logs (retention_policy text, error_message text, metadata jsonb, old_values jsonb, risk_level text NOT NULL DEFAULT 'low'::text, resource_type text, request_body jsonb, action text NOT NULL, session_id text, created_at timestamp without time zone NOT NULL DEFAULT now(), correlation_id character varying, encryption_key_id character varying, severity text DEFAULT 'info'::text, resource_id text, request_id character varying, details jsonb, tags jsonb, compliance_flags jsonb, status_code integer, user_agent text, updated_at timestamp without time zone DEFAULT now(), category text, resource text NOT NULL, user_id character varying, ip_address text NOT NULL, new_values jsonb, user_email text, method text, request_params jsonb, data_classification text, outcome text, timestamp timestamp without time zone DEFAULT now(), id integer NOT NULL DEFAULT nextval('audit_logs_id_seq'::regclass), geolocation jsonb, device_info jsonb, notes text, response_time integer, environment text DEFAULT 'production'::text, endpoint text, application_version text);
CREATE TABLE public.business_ownership (ownership_percentage numeric NOT NULL, signature_token text, signature_image_path text, signed_at timestamp without time zone, owner_email text NOT NULL, owner_name text NOT NULL, id integer NOT NULL DEFAULT nextval('business_ownership_id_seq'::regclass), updated_at timestamp without time zone NOT NULL DEFAULT now(), digital_signature text, requires_signature boolean NOT NULL DEFAULT false, prospect_id integer, signature_type text, form_submission_id integer, created_at timestamp without time zone NOT NULL DEFAULT now());
CREATE TABLE public.campaign_application_templates (is_primary boolean NOT NULL DEFAULT false, id integer NOT NULL DEFAULT nextval('campaign_application_templates_id_seq'::regclass), display_order integer NOT NULL DEFAULT 0, template_id integer NOT NULL, created_at timestamp without time zone NOT NULL DEFAULT now(), campaign_id integer NOT NULL);
CREATE TABLE public.campaign_assignments (campaign_id integer NOT NULL, id integer NOT NULL DEFAULT nextval('campaign_assignments_id_seq'::regclass), assigned_at timestamp without time zone NOT NULL DEFAULT now(), assigned_by character varying, is_active boolean NOT NULL DEFAULT true, prospect_id integer, application_id integer);
CREATE TABLE public.campaign_equipment (equipment_item_id integer NOT NULL, id integer NOT NULL DEFAULT nextval('campaign_equipment_id_seq'::regclass), display_order integer NOT NULL DEFAULT 0, created_at timestamp without time zone NOT NULL DEFAULT now(), is_required boolean NOT NULL DEFAULT false, campaign_id integer NOT NULL);
CREATE TABLE public.campaign_fee_values (id integer NOT NULL DEFAULT nextval('campaign_fee_values_id_seq'::regclass), updated_at timestamp without time zone NOT NULL DEFAULT now(), value text NOT NULL, campaign_id integer NOT NULL, fee_group_fee_item_id integer, fee_item_id integer NOT NULL, value_type text NOT NULL DEFAULT 'percentage'::text, created_at timestamp without time zone NOT NULL DEFAULT now());
CREATE TABLE public.campaigns (is_default boolean NOT NULL DEFAULT false, acquirer_id integer NOT NULL, id integer NOT NULL DEFAULT nextval('campaigns_id_seq'::regclass), created_at timestamp without time zone NOT NULL DEFAULT now(), is_active boolean NOT NULL DEFAULT true, created_by character varying, description text, pricing_type_id integer, name text NOT NULL, updated_at timestamp without time zone NOT NULL DEFAULT now(), currency text NOT NULL DEFAULT 'USD'::text, acquirer text, equipment text);
CREATE TABLE public.companies (name text NOT NULL, website text, updated_at timestamp without time zone NOT NULL DEFAULT now(), id integer NOT NULL DEFAULT nextval('companies_id_seq'::regclass), description text, settings jsonb DEFAULT '{}'::jsonb, address jsonb, status text NOT NULL DEFAULT 'active'::text, email text, industry text, logo_url text, business_type text, created_at timestamp without time zone NOT NULL DEFAULT now(), phone text, tax_id character varying);
CREATE TABLE public.company_addresses (type text NOT NULL DEFAULT 'primary'::text, created_at timestamp without time zone NOT NULL DEFAULT now(), id integer NOT NULL DEFAULT nextval('company_addresses_id_seq'::regclass), address_id integer NOT NULL, company_id integer NOT NULL);
CREATE TABLE public.data_access_logs (retention_period integer, access_reason text, record_id text, field_accessed text, data_type text NOT NULL, access_type text NOT NULL, lawful_basis text, user_id character varying NOT NULL, audit_log_id integer, table_name text NOT NULL, data_volume integer, id integer NOT NULL DEFAULT nextval('data_access_logs_id_seq'::regclass), created_at timestamp without time zone NOT NULL DEFAULT now());
CREATE TABLE public.email_activity (clicked_at timestamp without time zone, error_message text, recipient_name character varying, opened_at timestamp without time zone, metadata jsonb, subject text NOT NULL, template_id integer, sent_at timestamp without time zone DEFAULT now(), triggered_by character varying, id integer NOT NULL DEFAULT nextval('email_activity_id_seq'::regclass), template_name character varying NOT NULL, status character varying NOT NULL, trigger_source character varying, recipient_email character varying NOT NULL);
CREATE TABLE public.email_templates (cta_button_text text, updated_at timestamp without time zone DEFAULT now(), header_subtitle text, id integer NOT NULL DEFAULT nextval('email_templates_id_seq'::regclass), header_gradient text, wrapper_type character varying DEFAULT 'notification'::character varying, text_content text, category character varying NOT NULL, is_active boolean DEFAULT true, created_at timestamp without time zone DEFAULT now(), cta_button_url text, use_wrapper boolean DEFAULT true, description text, name character varying NOT NULL, subject text NOT NULL, custom_footer text, html_content text NOT NULL, cta_button_color text, variables jsonb);
CREATE TABLE public.email_triggers (id integer NOT NULL DEFAULT nextval('email_triggers_id_seq'::regclass), description text, name character varying NOT NULL, conditions jsonb, is_active boolean DEFAULT true, created_at timestamp without time zone DEFAULT now(), template_id integer, trigger_event character varying NOT NULL, updated_at timestamp without time zone DEFAULT now());
CREATE TABLE public.email_wrappers (cta_button_color text, cta_button_text text, header_gradient text, updated_at timestamp without time zone DEFAULT now(), name character varying NOT NULL, type character varying NOT NULL, is_active boolean DEFAULT true, custom_footer text, cta_button_url text, created_at timestamp without time zone DEFAULT now(), id integer NOT NULL DEFAULT nextval('email_wrappers_id_seq'::regclass), header_subtitle text, description text);
CREATE TABLE public.equipment_items (updated_at timestamp without time zone NOT NULL DEFAULT now(), category text, id integer NOT NULL DEFAULT nextval('equipment_items_id_seq'::regclass), model_number text, price numeric, status text, name text NOT NULL, image_url text, specifications jsonb DEFAULT '{}'::jsonb, is_active boolean NOT NULL DEFAULT true, model text, created_at timestamp without time zone NOT NULL DEFAULT now(), description text, image_data text, manufacturer text);
CREATE TABLE public.fee_group_fee_items (fee_group_id integer NOT NULL, is_required boolean NOT NULL DEFAULT false, created_at timestamp without time zone NOT NULL DEFAULT now(), id integer NOT NULL DEFAULT nextval('fee_group_fee_items_id_seq'::regclass), fee_item_id integer NOT NULL, fee_item_group_id integer, display_order integer NOT NULL DEFAULT 0);
CREATE TABLE public.fee_groups (description text, author text NOT NULL DEFAULT 'System'::text, updated_at timestamp without time zone NOT NULL DEFAULT now(), id integer NOT NULL DEFAULT nextval('fee_groups_id_seq'::regclass), name text NOT NULL, is_active boolean NOT NULL DEFAULT true, display_order integer NOT NULL DEFAULT 0, created_at timestamp without time zone NOT NULL DEFAULT now());
CREATE TABLE public.fee_item_groups (created_at timestamp without time zone NOT NULL DEFAULT now(), fee_group_id integer NOT NULL, is_active boolean NOT NULL DEFAULT true, description text, id integer NOT NULL DEFAULT nextval('fee_item_groups_id_seq'::regclass), name text NOT NULL, author text NOT NULL DEFAULT 'System'::text, display_order integer NOT NULL DEFAULT 0, updated_at timestamp without time zone NOT NULL DEFAULT now());
CREATE TABLE public.fee_items (display_order integer NOT NULL DEFAULT 0, fee_item_group_id integer, id integer NOT NULL DEFAULT nextval('fee_items_id_seq'::regclass), author text NOT NULL DEFAULT 'System'::text, additional_info text, name text NOT NULL, value_type text NOT NULL, created_at timestamp without time zone NOT NULL DEFAULT now(), updated_at timestamp without time zone NOT NULL DEFAULT now(), description text, default_value text, is_active boolean NOT NULL DEFAULT true);
CREATE TABLE public.locations (phone text, status text NOT NULL DEFAULT 'active'::text, company_id integer, id integer NOT NULL DEFAULT nextval('locations_id_seq'::regclass), mid character varying, merchant_id integer, name text NOT NULL, email text, operating_hours jsonb, type text NOT NULL DEFAULT 'store'::text, created_at timestamp without time zone NOT NULL DEFAULT now());
CREATE TABLE public.login_attempts (created_at timestamp without time zone DEFAULT now(), failure_reason character varying, username character varying, success boolean NOT NULL, email character varying, user_agent text, id integer NOT NULL DEFAULT nextval('login_attempts_id_seq'::regclass), ip_address character varying NOT NULL);
CREATE TABLE public.merchant_prospects (agent_signed_at timestamp without time zone, updated_at timestamp without time zone NOT NULL DEFAULT now(), status text NOT NULL DEFAULT 'pending'::text, agent_signature text, validated_at timestamp without time zone, last_name text NOT NULL, agent_signature_type text, notes text, form_data text, current_step integer DEFAULT 0, agent_id integer NOT NULL, email text NOT NULL, application_started_at timestamp without time zone, created_at timestamp without time zone NOT NULL DEFAULT now(), first_name text NOT NULL, validation_token text, id integer NOT NULL DEFAULT nextval('merchant_prospects_id_seq'::regclass));
CREATE TABLE public.merchants (business_type text, dba_name text, email text, agent_id integer, ein text, monthly_volume numeric NOT NULL DEFAULT 0, updated_at timestamp with time zone, phone text, processing_fee numeric NOT NULL DEFAULT 2.50, status text NOT NULL DEFAULT 'active'::text, notes text, id integer NOT NULL DEFAULT nextval('merchants_id_seq'::regclass), legal_name text, company_id integer NOT NULL, created_at timestamp without time zone NOT NULL DEFAULT now(), industry text, user_id character varying, business_name text, website text);
CREATE TABLE public.pdf_form_fields (field_type text NOT NULL, field_label text NOT NULL, section text, form_id integer NOT NULL, created_at timestamp without time zone DEFAULT now(), position integer NOT NULL, id integer NOT NULL DEFAULT nextval('pdf_form_fields_id_seq'::regclass), pdf_field_id text, field_name text NOT NULL, options ARRAY, validation text, default_value text, is_required boolean DEFAULT false);
CREATE TABLE public.pdf_form_submissions (id integer NOT NULL DEFAULT nextval('pdf_form_submissions_id_seq'::regclass), created_at timestamp without time zone DEFAULT now(), is_public boolean DEFAULT false, submission_token text NOT NULL, applicant_email text, status text DEFAULT 'draft'::text, submitted_by text, updated_at timestamp without time zone DEFAULT now(), form_id integer NOT NULL, data text NOT NULL);
CREATE TABLE public.pdf_forms (name text NOT NULL, allowed_roles ARRAY DEFAULT '{admin}'::text[], description text, file_size integer NOT NULL, show_in_navigation boolean DEFAULT false, file_name text NOT NULL, updated_at timestamp without time zone DEFAULT now(), status text DEFAULT 'active'::text, uploaded_by text NOT NULL, navigation_title text, created_at timestamp without time zone DEFAULT now(), id integer NOT NULL DEFAULT nextval('pdf_forms_id_seq'::regclass));
CREATE TABLE public.pricing_type_fee_items (fee_item_id integer NOT NULL, id integer NOT NULL DEFAULT nextval('pricing_type_fee_items_id_seq'::regclass), is_required boolean NOT NULL DEFAULT true, created_at timestamp without time zone NOT NULL DEFAULT now(), pricing_type_id integer NOT NULL, display_order integer NOT NULL DEFAULT 0);
CREATE TABLE public.pricing_types (id integer NOT NULL DEFAULT nextval('pricing_types_id_seq'::regclass), updated_at timestamp without time zone NOT NULL DEFAULT now(), is_active boolean NOT NULL DEFAULT true, author text NOT NULL DEFAULT 'System'::text, description text, created_at timestamp without time zone NOT NULL DEFAULT now(), name text NOT NULL);
CREATE TABLE public.prospect_applications (prospect_id integer NOT NULL, status text NOT NULL DEFAULT 'draft'::text, created_at timestamp without time zone NOT NULL DEFAULT now(), template_id integer NOT NULL, submitted_at timestamp without time zone, template_version text NOT NULL, generated_pdf_path text, id integer NOT NULL DEFAULT nextval('prospect_applications_id_seq'::regclass), rejected_at timestamp without time zone, updated_at timestamp without time zone NOT NULL DEFAULT now(), rejection_reason text, approved_at timestamp without time zone, application_data jsonb NOT NULL DEFAULT '{}'::jsonb, acquirer_id integer NOT NULL);
CREATE TABLE public.prospect_owners (prospect_id integer NOT NULL, email text NOT NULL, ownership_percentage numeric NOT NULL, email_sent boolean DEFAULT false, signature_token text, created_at timestamp without time zone DEFAULT now(), id integer NOT NULL DEFAULT nextval('prospect_owners_id_seq'::regclass), email_sent_at timestamp without time zone, name text NOT NULL, updated_at timestamp without time zone DEFAULT now());
CREATE TABLE public.prospect_signatures (prospect_id integer NOT NULL, signature_token text NOT NULL, id integer NOT NULL DEFAULT nextval('prospect_signatures_id_seq'::regclass), signature_type text NOT NULL, submitted_at timestamp without time zone DEFAULT now(), owner_id integer NOT NULL, signature text NOT NULL);
CREATE TABLE public.schema_migrations (name character varying NOT NULL, migration_id character varying NOT NULL, checksum character varying NOT NULL, id integer NOT NULL DEFAULT nextval('schema_migrations_id_seq'::regclass), environment character varying NOT NULL, applied_at timestamp without time zone DEFAULT CURRENT_TIMESTAMP);
CREATE TABLE public.security_events (alert_status text DEFAULT 'new'::text, event_type text NOT NULL, resolved_at timestamp without time zone, mitigation_actions jsonb, assigned_to character varying, detection_method text, detected_by text, affected_resources jsonb, resolved_by character varying, detected_at timestamp without time zone NOT NULL DEFAULT now(), audit_log_id integer, resolution text, severity text NOT NULL, affected_users jsonb, updated_at timestamp without time zone NOT NULL DEFAULT now(), id integer NOT NULL DEFAULT nextval('security_events_id_seq'::regclass), investigation_notes text, created_at timestamp without time zone NOT NULL DEFAULT now());
CREATE TABLE public.sessions (sid character varying NOT NULL, sess jsonb NOT NULL, expire timestamp without time zone NOT NULL);
CREATE TABLE public.signature_captures (timestamp_requested timestamp without time zone, signer_name text, ownership_percentage numeric, created_at timestamp without time zone NOT NULL DEFAULT now(), timestamp_expires timestamp without time zone, initials text, signer_type text NOT NULL, timestamp_signed timestamp without time zone, id integer NOT NULL DEFAULT nextval('signature_captures_id_seq'::regclass), request_token text, notes text, signer_email text, application_id integer, role_key text NOT NULL, status text NOT NULL DEFAULT 'pending'::text, updated_at timestamp without time zone NOT NULL DEFAULT now(), date_signed timestamp without time zone, signature_type text, signature text, prospect_id integer);
CREATE TABLE public.transactions (commission_amount numeric DEFAULT 0, location_id integer, status text NOT NULL, processed_at timestamp with time zone, reference_number text, transaction_date timestamp with time zone DEFAULT CURRENT_TIMESTAMP, merchant_id integer NOT NULL, created_at timestamp without time zone DEFAULT now(), transaction_id text NOT NULL, processing_fee numeric, mid character varying, net_amount numeric, amount numeric NOT NULL, commission_rate numeric DEFAULT 0.025, transaction_type text NOT NULL DEFAULT 'payment'::text, payment_method text NOT NULL, id integer NOT NULL DEFAULT nextval('transactions_id_seq'::regclass));
CREATE TABLE public.trigger_actions (id integer NOT NULL DEFAULT nextval('trigger_actions_id_seq'::regclass), conditions jsonb, requires_email_preference boolean DEFAULT false, is_active boolean DEFAULT true, delay_seconds integer DEFAULT 0, requires_sms_preference boolean DEFAULT false, retry_on_failure boolean DEFAULT true, max_retries integer DEFAULT 3, created_at timestamp without time zone DEFAULT now(), sequence_order integer DEFAULT 1, trigger_id integer NOT NULL, action_template_id integer NOT NULL, updated_at timestamp without time zone DEFAULT now());
CREATE TABLE public.trigger_catalog (context_schema jsonb, category character varying NOT NULL, description text, name character varying NOT NULL, id integer NOT NULL DEFAULT nextval('trigger_catalog_id_seq'::regclass), updated_at timestamp without time zone DEFAULT now(), created_at timestamp without time zone DEFAULT now(), trigger_key character varying NOT NULL, is_active boolean DEFAULT true);
CREATE TABLE public.two_factor_codes (created_at timestamp without time zone DEFAULT now(), expires_at timestamp without time zone NOT NULL, used boolean DEFAULT false, code character varying NOT NULL, user_id character varying NOT NULL, type character varying NOT NULL, id integer NOT NULL DEFAULT nextval('two_factor_codes_id_seq'::regclass));
CREATE TABLE public.user_alerts (action_url text, id integer NOT NULL DEFAULT nextval('user_alerts_id_seq'::regclass), is_read boolean NOT NULL DEFAULT false, message text NOT NULL, user_id character varying NOT NULL, read_at timestamp without time zone, type character varying NOT NULL DEFAULT 'info'::character varying, created_at timestamp without time zone NOT NULL DEFAULT now(), action_activity_id integer);
CREATE TABLE public.user_company_associations (created_at timestamp without time zone NOT NULL DEFAULT now(), start_date timestamp without time zone, permissions jsonb DEFAULT '{}'::jsonb, company_role text NOT NULL, is_active boolean NOT NULL DEFAULT true, is_primary boolean NOT NULL DEFAULT false, department text, updated_at timestamp without time zone NOT NULL DEFAULT now(), company_id integer NOT NULL, user_id character varying NOT NULL, title text, id integer NOT NULL DEFAULT nextval('user_company_associations_id_seq'::regclass), end_date timestamp without time zone);
CREATE TABLE public.user_dashboard_preferences (created_at timestamp without time zone NOT NULL DEFAULT now(), size text NOT NULL DEFAULT 'medium'::text, widget_id text NOT NULL, updated_at timestamp without time zone NOT NULL DEFAULT now(), id integer NOT NULL, position integer NOT NULL DEFAULT 0, configuration jsonb DEFAULT '{}'::jsonb, user_id text NOT NULL, is_visible boolean NOT NULL DEFAULT true);
CREATE TABLE public.users (password_reset_expires timestamp without time zone, username character varying NOT NULL, id character varying NOT NULL, profile_image_url character varying, status text NOT NULL DEFAULT 'active'::text, phone character varying, last_login_at timestamp without time zone, email_verification_token character varying, communication_preference text DEFAULT 'email'::text, last_name character varying, email character varying NOT NULL, created_at timestamp without time zone DEFAULT now(), two_factor_secret character varying, roles ARRAY NOT NULL DEFAULT ARRAY['merchant'::text], password_reset_token character varying, last_login_ip character varying, first_name character varying, updated_at timestamp without time zone DEFAULT now(), password_hash character varying NOT NULL, email_verified boolean DEFAULT false, timezone character varying DEFAULT 'UTC'::character varying, permissions jsonb DEFAULT '{}'::jsonb, two_factor_enabled boolean DEFAULT false);